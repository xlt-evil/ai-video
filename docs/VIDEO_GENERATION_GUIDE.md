# 火山引擎视频生成使用指南

## 🎬 快速开始

### 1. 配置 API Key

在使用视频生成功能之前，需要先配置火山引擎的 API Key。

**方式一：通过 UI 配置（推荐）**

1. 点击左下角的 ⚙️ 设置按钮
2. 在 "基础配置" 部分填入您的 API Key
3. （可选）在 "视频生成配置" 部分调整视频参数：
   - 分辨率：720p / 1080p / 2K
   - 视频时长：1-10 秒
   - 宽高比：16:9 / 9:16 / 1:1
   - 镜头运动：开启/关闭
   - 水印：开启/关闭
4. 点击 "💾 保存配置" 按钮

**方式二：通过环境变量配置**

创建 `.env.local` 文件：

```bash
# API Key（必填）
ARK_API_KEY=your_api_key_here

# 视频配置（可选）
ARK_VIDEO_RESOLUTION=1080p
ARK_VIDEO_DURATION=5
ARK_VIDEO_RATIO=16:9
```

### 2. 生成视频

在聊天输入框中输入包含 "生成视频" 关键词的描述，例如：

- ✅ "生成一个跑来跑去的视频"
- ✅ "生成一个无人机穿越峡谷的视频"
- ✅ "创建一个海浪拍打礁石的视频"
- ✅ "制作一个城市夜景延时摄影的动画"

### 3. 等待生成

系统会自动：

1. 🔄 创建视频生成任务
2. 📊 显示任务 ID 和当前状态
3. ⏳ 轮询任务进度（每3秒查询一次）
4. ✅ 任务完成后显示视频播放器

整个过程通常需要 **1-5 分钟**，具体时间取决于视频长度和服务器负载。

### 4. 查看和下载

生成成功后，您可以：

- 🎥 **直接预览**：在聊天界面中播放视频
- 📥 **下载视频**：点击 "下载视频" 按钮保存到本地
- 🔗 **新窗口打开**：在新标签页中查看视频

## 💡 使用技巧

### 提示词建议

好的提示词能显著提高视频质量：

**✅ 推荐的提示词格式：**

```
[主体] + [动作] + [场景] + [镜头运动] + [氛围/风格]
```

**示例：**

1. **自然风光**
   ```
   生成视频：无人机以极快速度穿越复杂障碍或自然奇观，带来沉浸式飞行体验
   ```

2. **动物主题**
   ```
   生成视频：一只猎豹在草原上全速奔跑，镜头跟随追踪，展现速度与力量
   ```

3. **城市景观**
   ```
   生成视频：城市夜景延时摄影，车流如河，灯光璀璨，镜头缓缓升起
   ```

4. **抽象艺术**
   ```
   生成视频：彩色烟雾在黑色背景中翻腾，镜头缓慢旋转，呈现梦幻效果
   ```

### 参数调整

不同场景建议使用不同的参数：

| 场景类型 | 分辨率 | 时长 | 宽高比 | 镜头运动 |
|---------|-------|------|--------|---------|
| 风景延时 | 2K | 10秒 | 16:9 | ✓ |
| 产品展示 | 1080p | 5秒 | 16:9 | ✓ |
| 社交媒体 | 1080p | 5秒 | 9:16 | ✓ |
| 方形视频 | 1080p | 5秒 | 1:1 | ✓ |
| 静态镜头 | 1080p | 3秒 | 16:9 | ✗ |

## ❗ 常见问题

### Q1: 提示 "请先在设置中配置 API Key"

**解决方案：**
- 点击左下角 ⚙️ 设置按钮
- 填写您的火山引擎 API Key
- 点击保存

### Q2: 视频生成失败

**可能的原因：**
1. **API Key 无效**：检查 API Key 是否正确
2. **余额不足**：确认账户有足够的余额
3. **网络问题**：检查网络连接
4. **提示词不合规**：避免使用敏感或违规内容

### Q3: 生成速度很慢

**说明：**
- 视频生成是 AI 密集型任务，通常需要 1-5 分钟
- 时长越长，生成时间越久
- 高分辨率（2K）比低分辨率需要更多时间
- 系统每 3 秒自动查询一次进度

### Q4: 如何提高视频质量？

**建议：**
1. 使用详细、具体的提示词
2. 选择合适的分辨率（1080p 或 2K）
3. 适当调整视频时长（5-10秒效果较好）
4. 启用镜头运动增加动感
5. 多次尝试，优化提示词

### Q5: 视频可以商用吗？

**说明：**
- 请参考火山引擎的服务条款
- 建议咨询火山引擎官方客服
- 注意版权和使用限制

## 🔧 技术细节

### API 流程

```typescript
// 1. 创建任务
const task = await createVideoTask(config, prompt);
// 返回: { id: "cgt-xxx" }

// 2. 轮询状态
const result = await waitForTask(config, task.id, (status) => {
  console.log('当前状态:', status.status);
  // pending -> processing -> succeeded
});

// 3. 获取视频
if (result.status === 'succeeded') {
  const videoUrl = result.content.video_url;
}
```

### 任务状态说明

| 状态 | 说明 | 处理时间 |
|-----|------|---------|
| `pending` | 任务已创建，等待处理 | 几秒 |
| `processing` | 正在生成视频 | 1-5分钟 |
| `succeeded` | 生成成功 | - |
| `failed` | 生成失败 | - |

### 视频 URL 有效期

- 生成的视频 URL 通常有 **24小时** 的有效期
- 建议及时下载重要视频
- URL 包含临时访问令牌（Token）

## 📚 参考资料

- [火山引擎视频生成 API 文档](https://www.volcengine.com/docs/82379/1520757)
- [查询任务状态文档](https://www.volcengine.com/docs/82379/1521309)
- [火山引擎控制台](https://console.volcengine.com/)

## 🎯 最佳实践

### 1. 批量生成

如果需要生成多个视频：

```typescript
const prompts = [
  "日出时分的山峰",
  "夜晚城市的车流",
  "海浪拍打礁石"
];

// 串行生成（推荐，避免并发限制）
for (const prompt of prompts) {
  await createAndWaitVideo(prompt);
}
```

### 2. 错误重试

添加重试逻辑提高成功率：

```typescript
async function generateWithRetry(prompt: string, maxRetries = 3) {
  for (let i = 0; i < maxRetries; i++) {
    try {
      return await createVideoTask(config, prompt);
    } catch (error) {
      if (i === maxRetries - 1) throw error;
      await sleep(5000); // 等待5秒后重试
    }
  }
}
```

### 3. 提示词模板

创建提示词模板库：

```typescript
const templates = {
  nature: (subject: string) => 
    `${subject}的美景，镜头缓慢推进，展现细节之美`,
  
  action: (subject: string) => 
    `${subject}快速运动，镜头跟随，展现速度与激情`,
  
  timelapse: (scene: string) => 
    `${scene}的延时摄影，展现时光流逝的美感`
};

// 使用
const prompt = templates.nature("樱花盛开");
```

## 💬 技术支持

遇到问题？欢迎：

- 📧 查看项目 README.md
- 💬 提交 GitHub Issue
- 🔗 访问火山引擎官方文档
- 🎯 查看示例代码

---

**祝您使用愉快！🎉**

